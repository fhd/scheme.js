var scheme=function(a){function d(a){return a.replace(/;.*/g,"")}function e(a){return a.match(/("[^"]*"|[()]|[^\s()]+)/g)}function f(b){var c=b[0],d=b.length-1,e=b[d];if(c==='"'||e==='"'){if(c!==e)throw"Unexpected EOF while reading string";return b.substring(1,d)}if(c==="#"){var f=b.substring(1);if(f==="t")return!0;if(f==="f")return!1;throw"Not a valid boolean literal: "+f}var g=parseFloat(b);return isNaN(g)?new a.Symbol(b):g}function g(b,c){if(b.length===0)throw"Unexpected EOF while reading";var d=b[0];b.shift();if(d==="'")return[new a.Symbol("quote"),g(b,c)];if(d==="`")return[new a.Symbol("quasiquote"),g(b,!0)];if(d===",")return[new a.Symbol("unquote"),g(b,c)];if(d==="("){var e=[];while(b[0]!==")")e.push(g(b,c));b.shift();for(var h=0;h<e.length;h++)if(e[h].toString()==="."){if(h===0||h!==e.length-2)throw"Invalid dotted list";if(e.length===3)return c?new a.Pair(e[0],e[2]):a.standardProcedures.cons(e[0],e[2]);break}return e}if(d===")")throw"Unexpected )";return f(d)}function h(b,d){var e=b[0].toString().substring(1),f=b[1];if(f instanceof a.Symbol)var g=f.toString(),h=g==="js"?this:i(f,d)||this.eval(g);else h=i(f,d);var j=k(b.slice(2),d);return new c(h,e)}function i(c,d){if(c instanceof a.Symbol){var e=c.toString();return e[0]==="'"?new a.Symbol(e.substring(1)):d.get(e)}if(!a.utils.isArray(c))return c;var f=c[0];if(f instanceof a.Symbol&&f.toString()[0]===".")return h(c,d);var g=b[f];return g?g.apply(null,[d].concat(c)):a.callProcedure(c,d)}function j(a,c){return b.begin.apply(null,[a,null].concat(Array.prototype.slice.call(c,3)))}function k(b,c){return a.utils.map(b,function(a){return i(a,c)})}function l(b){if(typeof b=="string")return'"'+b+'"';if(typeof b=="boolean")return b?"#t":"#f";if(b instanceof a.Symbol)return b.toString();if(a.utils.isArray(b)){var c="(";return a.utils.forEach(b,function(a){c.length>1&&(c+=" "),c+=l(a)}),c+")"}return a.utils.isFunction(b)?"#procedure":typeof b=="object"?JSON.stringify(b):b}var b={"if":function(a,b,c,d,e){return i(i(c,a)?d:e,a)},define:function(c,d,e,f){if(!a.utils.isArray(e)){c.define(e,i(f,c));return}var g=e[0],h=e.slice(1),j=[new a.Symbol("begin")].concat(Array.prototype.slice.call(arguments,3));c.define(g,b.lambda(c,d,h,j))},"set!":function(d,e,f,g){if(f instanceof a.Symbol){var h=f.toString();if(typeof d.get(h)=="undefined")throw"Unbound variable: "+h;d.set(h,g)}else f instanceof c?f.set(g):b["set!"](d,e,i(f,d),g)},lambda:function(b,c,d,e){return function(){var c=Math.min(d.length,arguments.length),f={};for(var g=0;g<c;g++)f[d[g]]=i(arguments[g],b);return i(e,new a.Environment(f,b))}},quote:function(a,b,c){return c},quasiquote:function(b,c,d){function e(b,c){if(b instanceof a.Pair)return new a.Pair(e(b.car,c),e(b.cdr,c));if(!a.utils.isArray(b)||!b.length)return b;var d=b[0];return d instanceof a.Symbol&&d.toString()==="unquote"?i(b[1],c):a.utils.map(b,function(a){return e(a,c)})}return e(d,b)},begin:function(b){var c;return a.utils.forEach(Array.prototype.slice.call(arguments,2),function(a){c=i(a,b)}),c},and:function(a,b,c,d){return i(c,a)&&i(d,a)},or:function(a,b,c,d){return i(c,a)||i(d,a)},let:function(b,c,d){var e={};return a.utils.forEach(d,function(a){e[a[0]]=i(a[1],b)}),j(new a.Environment(e,b),arguments)},"let*":function(b,c,d){var e={},f;return a.utils.forEach(d,function(c){e[c[0]]=i(c[1],f),f=new a.Environment(e,b)}),j(f,arguments)},"try":function(a,b,c,d){try{return i(c,a)}catch(e){if(!d)throw e;var f=i(d,a);return f(e)}}},c=function(a,b){this.object=a,this.property=b};return c.prototype={get:function(){return this.object[this.property]},set:function(a){this.object[this.property]=a},toString:function(){return this.get().toString()}},a.Environment=function(b,c){this.entries=b||{},this.outer=c||null,!b&&!c&&(this.entries=a.standardProcedures,this.entries.js=this)},a.Environment.prototype={get:function(a){var b=this.entries[a];return typeof b!="undefined"?b:this.outer?this.outer.get(a):undefined},define:function(a,b){this.entries[a]=b},set:function(a,b){this.outer&&typeof this.outer.get(a)!="undefined"?this.outer.set(a,b):this.define(a,b)}},a.Symbol=function(a){this.s=a},a.Symbol.prototype={toString:function(){return this.s}},a.Pair=function(a,b){this.car=a,this.cdr=b},a.read=function(a){var b=e(d(a)),c=[];while(b.length)c.push(g(b));return c},a.callProcedure=function(a,b){var d=b?k(a,b):a,e=d[0];if(!e)throw a[0]+" is not a procedure";return d.shift(),e instanceof c?e.get().apply(e.object,d):e.apply(null,d)},a.eval=function(b,d){return a.utils.map(k(b,d||new a.Environment),function(a){return a instanceof c?a.get():a})},a.evalString=function(b,c){return a.eval(a.read(b),c)},a.print=function(a){var b="";for(var c=0;c<a.length;c++)c>0&&(b+="\n"),b+=l(a[c]);return b},typeof window!="undefined"?(a.load=function(b,c){var d;return a.utils.httpGet(b,function(b){d=a.evalString(b,c)},!1),d},window.onload=function(){var b=document.getElementsByTagName("script");a.utils.forEach(b,function(b){if(b.type!=="text/x-scheme")return;b.src.length?a.load(b.src):a.evalString(b.innerHTML)})}):a.load=function(b,c){var d=require("fs"),e=d.readFileSync(b,"utf-8");return a.evalString(e,c)},a}(typeof exports!="undefined"?exports:{});scheme.utils=function(a){return{forEach:function(a,b){for(var c=0;c<a.length;c++)b(a[c])},map:function(a,b){var c=[];for(var d=0;d<a.length;d++)c.push(b(a[d]));return c},isArray:function(a){return Object.prototype.toString.call(a)==="[object Array]"},isFunction:function(a){return a&&{}.toString.call(a)==="[object Function]"},httpGet:function(a,b,c){var d;window.XMLHttpRequest?d=new XMLHttpRequest:window.ActiveXObject&&(d=new ActiveXObject("Microsoft.XMLHTTP")),d.onreadystatechange=function(){if(d.readyState!==4)return;var c=d.status;if(c!==0&&c!==200)throw"Unable to load scheme script from: "+a+", status: "+statusText;b(d.responseText)},d.open("GET",a,c),d.send()}}}(scheme),scheme.standardProcedures=function(a){return{"=":function(a,b){return a===b},">":function(a,b){return a>b},"<":function(a,b){return a<b},">=":function(a,b){return a>=b},"<=":function(a,b){return a<=b},"+":function(){var b=0;return a.utils.forEach(arguments,function(a){b+=a}),b},"-":function(){var b=arguments[0];return arguments.length===1?-b:(a.utils.forEach(Array.prototype.slice.call(arguments,1),function(a){b-=a}),b)},"*":function(){var b=1;return a.utils.forEach(arguments,function(a){b*=a}),b},"/":function(){var b=arguments[0];return arguments.length===1?1/b:(a.utils.forEach(Array.prototype.slice.call(arguments,1),function(a){b/=a}),b)},"string-append":function(){var b="";return a.utils.forEach(arguments,function(a){b+=a}),b},cons:function(b,c){return a.utils.isArray(c)?c.length?[b].concat(c):[b]:c instanceof a.Pair?[b].concat(c.car,new a.Symbol("."),c.cdr):new a.Pair(b,c)},apply:function(b,c){return a.callProcedure([b].concat(c))},"new":function(){this.schemeTemp={constructor:arguments[0].get(),args:Array.prototype.slice.call(arguments,1)};var a="new this.schemeTemp.constructor(";for(var b=0;b<this.schemeTemp.args.length;b++)b>0&&(a+=","),a+="this.schemeTemp.args["+b+"]";a+=");";var c=this.eval(a);return delete this.schemeTemp,c},"make-object":function(b){var c={};return a.utils.forEach(b,function(a){c[a.car]=a.cdr}),c},read:function(b){return a.read(b)},eval:function(b,c){return a.eval([b],c)[0]},print:function(b){return a.print(b)},"eval-string":function(b,c){return a.evalString(b,c)},load:function(b,c){return a.load(b,c)}}}(scheme);