var scheme={};(function(a){function f(a,b){var c;for(c=0;c<a.length;c++)b(a[c])}function g(a,c){return b.begin.apply(null,[a,null].concat(Array.prototype.slice.call(c,3)))}function h(a){return a.replace(/;.*/g,"")}function i(a){return a.match(/("[^"]*"|[()]|[^\s()]+)/g)}function j(a){var b=a[0],d=a.length-1,e=a[d],f,g;if(b==='"'||e==='"'){if(b!==e)throw"Unexpected EOF while reading string";return a.substring(1,d)}if(b==="#"){f=a.substring(1);if(f==="t")return!0;if(f==="f")return!1;throw"Not a valid boolean literal: "+f}return g=parseFloat(a),isNaN(g)?new c(a):g}function k(a,b){return n(b)?b.length?[a].concat(b):[a]:b instanceof e?[a].concat(b.car,new c("."),b.cdr):new e(a,b)}function l(a){var b,d,e,f;if(a.length===0)throw"Unexpected EOF while reading";b=a[0],a.shift();if(b==="'")return[new c("quote"),l(a)];if(b==="("){f=[];while(a[0]!==")")f.push(l(a));a.shift();for(e=0;e<f.length;e++)if(f[e].toString()==="."){if(e===0||e!==f.length-2)throw"Invalid dotted list";if(f.length===3)return k(f[0],f[2]);break}return f}if(b===")")throw"Unexpected )";return j(b)}function m(a){var b=i(h(a)),c=[];while(b.length)c.push(l(b));return c}function n(a){return Object.prototype.toString.call(a)==="[object Array]"}function o(a,b){var c=[],d;for(d=0;d<a.length;d++)c.push(b(a[d]));return c}function p(a,b){var e=a[0].toString().substring(1),f=a[1],g,h,i;return f instanceof c?(g=f.toString(),h=g==="js"?this:r(f,b)||this.eval(g)):h=f,i=s(a.slice(2),b),new d(h,e)}function q(a,b){var c=b?s(a,b):a,e=c[0];if(!e)throw a[0]+" is not a procedure";return c.shift(),e instanceof d?e.get().apply(e.object,c):e.apply(null,c)}function r(a,d){var e,f,g,h,i,j;return a instanceof c?(e=a.toString(),e[0]==="'"?e.substring(1):d.get(e)):n(a)?(f=a[0],f instanceof c&&f.toString()[0]==="."?p(a,d):(h=b[f],h?h.apply(null,[d].concat(a)):q(a,d))):a}function s(a,b){return o(a,function(a){return r(a,b)})}function t(a,b){var c;window.XMLHttpRequest?c=new XMLHttpRequest:window.ActiveXObject&&(c=new ActiveXObject("Microsoft.XMLHTTP")),c.onreadystatechange=function(){if(c.readyState!==4)return;var d=c.status;if(d!==0&&d!==200)throw"Unable to load scheme script from: "+a+", status: "+statusText;b(c.responseText)},c.open("GET",a),c.send()}var b={"if":function(a,b,c,d,e){return r(r(c,a)?d:e,a)},define:function(a,d,e,f){var g,h,i;if(!n(e)){a.set(e,r(f,a));return}g=e[0],h=e.slice(1),i=[new c("begin")].concat(Array.prototype.slice.call(arguments,3)),a.set(g,b.lambda(a,d,h,i))},"set!":function(a,e,f,g){var h;if(f instanceof c){h=f.toString();if(!a.get(h))throw"Unbound variable: "+h;a.set(h,g)}else f instanceof d?f.set(g):b["set!"](a,e,r(f,a),g)},lambda:function(b,c,d,e){return function(){var c,f;if(arguments.length!==d.length)throw"Invalid number of arguments. Expected "+d.length+", got "+arguments.length;c={};for(f=0;f<d.length;f++)c[d[f]]=r(arguments[f],b);return r(e,new a.Environment(c,b))}},quote:function(a,b,d){return d instanceof c?d.toString():d},begin:function(a){var b;return f(Array.prototype.slice.call(arguments,2),function(c){b=r(c,a)}),b},and:function(a,b,c,d){return r(c,a)&&r(d,a)},or:function(a,b,c,d){return r(c,a)||r(d,a)},let:function(b,c,d){var e={};return f(d,function(a){e[a[0]]=r(a[1],b)}),g(new a.Environment(e,b),arguments)},"let*":function(b,c,d){var e={},h;return f(d,function(c){e[c[0]]=r(c[1],h),h=new a.Environment(e,b)}),g(h,arguments)}},c=function(a){this.s=a},d=function(a,b){this.object=a,this.property=b},e=function(a,b){this.car=a,this.cdr=b};c.prototype={toString:function(){return this.s}},d.prototype={get:function(){return this.object[this.property]},set:function(a){this.object[this.property]=a},toString:function(){return this.get().toString()}},a.Environment=function(a,b){var c;this.entries=a||{},this.outer=b||null,!a&&!b&&(this.entries={"=":function(a,b){return a===b},"string-append":function(){var a="";return f(arguments,function(b){a+=b}),a},cons:k,apply:function(a,b){return q([a].concat(b))}},c=this,f(["+","-","*","/",">","<",">=","<="],function(a){c.entries[a]=function(b,c){return this.eval(b+a+c)}}))},a.Environment.prototype={get:function(a){return this.entries[a]||(this.outer?this.outer.get(a):null)},set:function(a,b){this.entries[a]=b}},a.eval=function(a,b){return o(s(m(a),b),function(a){return a instanceof d?a.get():a})},typeof window!="undefined"&&(window.onload=function(){var b=document.getElementsByTagName("script");f(b,function(b){if(b.type!=="text/scheme")return;b.src.length?t(b.src,function(b){a.eval(b)}):a.eval(b.innerHTML)})})})(typeof exports!="undefined"&&exports||scheme);